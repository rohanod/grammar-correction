The grammar correction tool uses a URL-based data format to encode corrections inline with the text. The data is passed as a query parameter in the URL.

## Data Encoding

A single `data` parameter contains a base64-encoded JSON string.

## Data Structure (Inline Format - Recommended for LLMs)

The inline format represents text as an array of segments, where each segment is either plain text or text with a correction. This format is LLM-friendly because it doesn't require counting character positions.

```json
{
  "segments": [
    {
      "text": "The text segment",
      "correction": {
        "corrected": "The corrected version",
        "type": "grammar" | "spelling" | "punctuation" | "word-choice" | "capitalization",
        "reason": "Explanation of the correction"
      }
    }
  ]
}
```

### Fields

- `segments`: Array of text segments that make up the complete text
  - `text`: The original text of this segment
  - `correction` (optional): If present, this segment contains a correction
    - `corrected`: The corrected version of the text
    - `type`: The category of the correction
    - `reason` (optional): Explanation for the correction

### Correction Types

- `grammar`: Grammar errors (subject-verb agreement, tense, etc.)
- `spelling`: Spelling mistakes
- `punctuation`: Missing or incorrect punctuation
- `word-choice`: Better word alternatives
- `capitalization`: Capitalization errors

## Example (Inline Format)

Here is an example showing the sentence "helo world! This are a example of grammer corrections" with corrections:

```json
{
  "segments": [
    {
      "text": "helo",
      "correction": {
        "corrected": "Hello",
        "type": "spelling",
        "reason": "Spelling error - correct spelling is 'Hello'"
      }
    },
    {
      "text": " world! This "
    },
    {
      "text": "are",
      "correction": {
        "corrected": "is",
        "type": "grammar",
        "reason": "Subject-verb agreement - singular 'This' requires 'is'"
      }
    },
    {
      "text": " "
    },
    {
      "text": "a",
      "correction": {
        "corrected": "an",
        "type": "grammar",
        "reason": "Article correction - use 'an' before vowel sounds"
      }
    },
    {
      "text": " example of "
    },
    {
      "text": "grammer",
      "correction": {
        "corrected": "grammar",
        "type": "spelling",
        "reason": "Spelling error - correct spelling is 'grammar'"
      }
    },
    {
      "text": " corrections"
    },
    {
      "text": "",
      "correction": {
        "corrected": ".",
        "type": "punctuation",
        "reason": "Sentence should end with a period"
      }
    }
  ]
}
```

## Legacy Format (Position-based)

The tool also supports the legacy position-based format for backward compatibility:

```json
{
  "original": "The original text.",
  "corrected": "The corrected version of the text.",
  "corrections": [
    {
      "type": "grammar",
      "original": "The incorrect word or phrase.",
      "corrected": "The corrected word or phrase.",
      "position": 0,
      "reason": "An explanation of why the correction was made."
    }
  ]
}
```

**Note**: The position-based format requires counting character positions (0-based index), which can be error-prone for LLMs. Use the inline format instead.

## Usage

This JSON object should be base64-encoded and appended to the URL as the `data` query parameter:

```
https://example.com/?data=<base64-encoded-json>
```
